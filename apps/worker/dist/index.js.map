{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import fs from \"node:fs\";\nimport path from \"node:path\";\n\nimport dotenv from \"dotenv\";\nimport { z } from \"zod\";\n\nfunction findUp(filename: string, startDir: string): string | undefined {\n  let dir = startDir;\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    const candidate = path.join(dir, filename);\n    if (fs.existsSync(candidate)) return candidate;\n    const parent = path.dirname(dir);\n    if (parent === dir) return undefined;\n    dir = parent;\n  }\n}\n\n// Load a repo-root `.env` if present (useful in local dev); production should\n// provide env vars via the host.\nconst envPath = findUp(\".env\", process.cwd());\nif (envPath) dotenv.config({ path: envPath });\n\nconst EnvSchema = z.object({\n  DATABASE_URL: z.string().min(1),\n  NODE_ENV: z.enum([\"development\", \"test\", \"production\"]).optional(),\n});\n\nconst env = EnvSchema.parse(process.env);\n\nasync function main() {\n  // Graphile Worker will be wired up in the next epic; for now we just validate env\n  // and prove the worker boots in all environments.\n  // eslint-disable-next-line no-console\n  console.log(\"[starbeam-worker] boot\", {\n    nodeEnv: env.NODE_ENV ?? \"development\",\n    hasDatabaseUrl: Boolean(env.DATABASE_URL),\n  });\n}\n\nmain().catch((err) => {\n  // eslint-disable-next-line no-console\n  console.error(\"[starbeam-worker] fatal\", err);\n  process.exitCode = 1;\n});\n\n"],"mappings":";AAAA,OAAO,QAAQ;AACf,OAAO,UAAU;AAEjB,OAAO,YAAY;AACnB,SAAS,SAAS;AAElB,SAAS,OAAO,UAAkB,UAAsC;AACtE,MAAI,MAAM;AAEV,SAAO,MAAM;AACX,UAAM,YAAY,KAAK,KAAK,KAAK,QAAQ;AACzC,QAAI,GAAG,WAAW,SAAS,EAAG,QAAO;AACrC,UAAM,SAAS,KAAK,QAAQ,GAAG;AAC/B,QAAI,WAAW,IAAK,QAAO;AAC3B,UAAM;AAAA,EACR;AACF;AAIA,IAAM,UAAU,OAAO,QAAQ,QAAQ,IAAI,CAAC;AAC5C,IAAI,QAAS,QAAO,OAAO,EAAE,MAAM,QAAQ,CAAC;AAE5C,IAAM,YAAY,EAAE,OAAO;AAAA,EACzB,cAAc,EAAE,OAAO,EAAE,IAAI,CAAC;AAAA,EAC9B,UAAU,EAAE,KAAK,CAAC,eAAe,QAAQ,YAAY,CAAC,EAAE,SAAS;AACnE,CAAC;AAED,IAAM,MAAM,UAAU,MAAM,QAAQ,GAAG;AAEvC,eAAe,OAAO;AAIpB,UAAQ,IAAI,0BAA0B;AAAA,IACpC,SAAS,IAAI,YAAY;AAAA,IACzB,gBAAgB,QAAQ,IAAI,YAAY;AAAA,EAC1C,CAAC;AACH;AAEA,KAAK,EAAE,MAAM,CAAC,QAAQ;AAEpB,UAAQ,MAAM,2BAA2B,GAAG;AAC5C,UAAQ,WAAW;AACrB,CAAC;","names":[]}